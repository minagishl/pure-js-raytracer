<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pure JS Ray Tracer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body class="bg-gray-900 text-white overflow-hidden">
  <div class="flex h-screen">
    <!-- Main Canvas Area -->
    <div class="flex-1 relative">
      <canvas id="raytracer-canvas" class="border border-gray-700"></canvas>

      <!-- Performance Stats -->
      <div class="absolute top-4 left-4 bg-black bg-opacity-50 p-3 rounded">
        <div class="text-green-400 text-sm">FPS: <span id="fps-counter">0</span></div>
        <div class="text-blue-400 text-sm">Render Time: <span id="render-time">0ms</span></div>
        <div class="text-yellow-400 text-sm">Rays: <span id="ray-count">0</span></div>
      </div>

      <!-- Instructions -->
      <div class="absolute bottom-4 left-4 bg-black bg-opacity-70 p-4 rounded text-xs max-w-sm">
        <div class="text-yellow-400 font-semibold mb-2">Controls:</div>
        <div class="grid grid-cols-1 gap-1">
          <div class="text-green-400">Mouse:</div>
          <div>• Click & drag: Rotate camera</div>
          <div>• Mouse wheel: Zoom in/out</div>

          <div class="text-green-400 mt-2">Movement (WASD + QE):</div>
          <div>• W/S: Forward/Backward</div>
          <div>• A/D: Left/Right</div>
          <div>• Q/E: Down/Up</div>

          <div class="text-green-400 mt-2">Camera (Arrows):</div>
          <div>• ←/→: Rotate left/right</div>
          <div>• ↑/↓: Rotate up/down</div>
          <div>• R: Reset camera</div>

          <div class="text-green-400 mt-2">Features:</div>
          <div>• Space: Toggle animation</div>
          <div>• I: Toggle importance sampling</div>
          <div>• H: Toggle HDR environment</div>
          <div>• T: Toggle denoising</div>
          <div>• K: Toggle keyframe animation</div>

          <div class="text-green-400 mt-2">Add Objects:</div>
          <div>• M: Add random sphere</div>
          <div>• V: Add random volume</div>
          <div>• L: Add random light</div>
        </div>
      </div>
    </div>

    <!-- Control Panel -->
    <div class="w-80 bg-gray-800 p-6 overflow-y-auto border-l border-gray-700">
      <h2 class="text-xl font-bold mb-6">Ray Tracer Controls</h2>

      <!-- Rendering Settings -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Rendering</h3>
        <div class="space-y-3">
          <div>
            <label class="block text-sm font-medium mb-1">Resolution</label>
            <select id="resolution" class="w-full bg-gray-700 border border-gray-600 rounded p-2">
              <option value="0.25">Quarter (Fast)</option>
              <option value="0.5" selected>Half (Balanced)</option>
              <option value="1.0">Full (Slow)</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">Max Bounces: <span id="bounces-value">3</span></label>
            <input type="range" id="max-bounces" min="1" max="8" value="3" class="w-full">
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">Anti-aliasing Samples: <span id="aa-value">1</span></label>
            <input type="range" id="anti-aliasing" min="1" max="4" value="1" class="w-full">
          </div>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" id="importance-sampling" class="mr-2">
              <span class="text-sm">Enable Importance Sampling</span>
            </label>
            <div>
              <label class="block text-sm font-medium mb-1">Indirect Samples: <span id="indirect-value">1</span></label>
              <input type="range" id="indirect-samples" min="1" max="8" value="1" class="w-full">
            </div>
          </div>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" id="denoising" class="mr-2">
              <span class="text-sm">Enable Denoising</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" id="temporal-accumulation" class="mr-2">
              <span class="text-sm">Temporal Accumulation</span>
            </label>
            <div>
              <label class="block text-sm font-medium mb-1">Denoising Strength: <span
                  id="denoising-value">1.0</span></label>
              <input type="range" id="denoising-strength" min="0" max="1" step="0.1" value="1.0" class="w-full">
            </div>
          </div>
        </div>
      </div>

      <!-- Scene Objects -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Objects</h3>
        <div id="objects-list" class="space-y-3">
          <!-- Objects will be dynamically added here -->
        </div>
        <button id="add-sphere" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded mt-3">
          Add Sphere
        </button>
        <button id="load-mesh" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded mt-3">
          Load Mesh (OBJ)
        </button>
        <button id="add-volume" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded mt-3">
          Add Volume
        </button>
        <div class="space-y-2 mt-3">
          <button id="save-scene"
            class="w-full bg-emerald-600 hover:bg-emerald-700 text-white py-1 px-2 rounded text-sm">
            Save Scene
          </button>
          <button id="load-scene" class="w-full bg-amber-600 hover:bg-amber-700 text-white py-1 px-2 rounded text-sm">
            Load Scene
          </button>
        </div>
        <input type="file" id="mesh-file-input" accept=".obj" style="display: none;">
        <input type="file" id="scene-file-input" accept=".json" style="display: none;">
      </div>

      <!-- Lighting -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Lighting</h3>
        <div id="lights-list" class="space-y-3">
          <!-- Lights will be dynamically added here -->
        </div>
        <button id="add-light" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white py-2 px-4 rounded mt-3">
          Add Light
        </button>
      </div>

      <!-- Camera -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Camera</h3>
        <div class="space-y-3">
          <div>
            <label class="block text-sm font-medium mb-1">Field of View: <span id="fov-value">45°</span></label>
            <input type="range" id="camera-fov" min="20" max="120" value="45" class="w-full">
          </div>
          <button id="reset-camera" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded">
            Reset Camera
          </button>
        </div>
      </div>

      <!-- Environment -->
      <div class="mb-6">
        <h3 class="text-lg font-semibold mb-3">Environment</h3>
        <div class="space-y-3">
          <div>
            <label class="block text-sm font-medium mb-1">Background Color</label>
            <input type="color" id="bg-color" value="#0f172a"
              class="w-full bg-gray-700 border border-gray-600 rounded p-1">
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">Ambient Light: <span id="ambient-value">0.1</span></label>
            <input type="range" id="ambient-light" min="0" max="1" step="0.1" value="0.1" class="w-full">
          </div>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" id="hdr-environment" class="mr-2">
              <span class="text-sm">Enable HDR Environment</span>
            </label>
            <button id="load-hdr" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-1 px-2 rounded text-sm">
              Load HDR Image
            </button>
            <div>
              <label class="block text-sm font-medium mb-1">Environment Intensity: <span
                  id="env-intensity-value">1.0</span></label>
              <input type="range" id="env-intensity" min="0" max="3" step="0.1" value="1.0" class="w-full">
            </div>
            <div>
              <label class="block text-sm font-medium mb-1">Environment Rotation: <span
                  id="env-rotation-value">0°</span></label>
              <input type="range" id="env-rotation" min="0" max="360" step="1" value="0" class="w-full">
            </div>
          </div>
          <input type="file" id="hdr-file-input" accept=".jpg,.jpeg,.png,.exr,.hdr" style="display: none;">
        </div>
      </div>

      <!-- Animation -->
      <div>
        <h3 class="text-lg font-semibold mb-3">Animation</h3>
        <div class="space-y-3">
          <button id="toggle-animation" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded">
            Start Animation
          </button>
          <div>
            <label class="block text-sm font-medium mb-1">Speed: <span id="speed-value">1.0x</span></label>
            <input type="range" id="animation-speed" min="0.1" max="3.0" step="0.1" value="1.0" class="w-full">
          </div>
          <div class="space-y-2">
            <label class="flex items-center">
              <input type="checkbox" id="use-keyframes" class="mr-2">
              <span class="text-sm">Use Keyframe Animation</span>
            </label>
            <div>
              <label class="block text-sm font-medium mb-1">Duration: <span id="duration-value">5.0s</span></label>
              <input type="range" id="animation-duration" min="1" max="20" step="0.5" value="5.0" class="w-full">
            </div>
            <button id="add-keyframe" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white py-1 px-2 rounded text-sm">
              Add Keyframe at Current Time
            </button>
            <button id="demo-keyframes"
              class="w-full bg-teal-600 hover:bg-teal-700 text-white py-1 px-2 rounded text-sm">
              Create Demo Animation
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="raytracer.js"></script>
</body>

</html>
